<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Planificador de Clases</title>
  <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/quill/1.3.7/quill.snow.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>

<body>
  <div class="container">
    <header class="header-with-nav">
      <div class="header-content">
        <div class="logo-section">
          <h1>Planificador de Clases</h1>
        </div>

        <div class="menu-container">
          <button class="menu-btn" onclick="toggleMenu()" id="menuBtn">
            <div class="menu-icon">
              <span></span>
              <span></span>
              <span></span>
            </div>
            Men√∫
          </button>
          <div class="dropdown-menu" id="dropdownMenu">
            <div class="menu-section">
              <div class="menu-section-title">Navegaci√≥n</div>
              <a href="https://guadidominguez0.github.io/Asistencia/" class="menu-item" style="text-decoration: none;">
                Asistencia
              </a>
              <button class="menu-item" onclick="switchTab('courses'); closeMenu();">
                Cursos
              </button>
              <button class="menu-item" onclick="switchTab('translate'); closeMenu();">
                Traducci√≥n
              </button>
            </div>

            <div class="menu-section">
              <div class="menu-section-title">Gesti√≥n de Datos</div>
              <button class="menu-item" onclick="planner.exportData(); closeMenu();">
                Exportar Datos
              </button>
              <button class="menu-item" onclick="triggerImport();">
                Importar Datos
              </button>
              <button class="menu-item danger" onclick="planner.clearAllData(); closeMenu();">
                Eliminar Todo
              </button>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Courses Tab -->
    <div id="coursesTab" class="tab-content active">
      <div class="card">
        <!-- Vista de Lista de Cursos -->
        <div id="coursesListView">
          <div class="courses-header">
            <h2>Mis Cursos</h2>
            <button class="btn" onclick="createNewCourse()">
              + Nuevo Curso
            </button>
          </div>
          <div id="coursesList" class="courses-grid">
            <div class="empty-state">
              <p>No tienes cursos creados a√∫n.<br>¬°Crea tu primer curso!</p>
            </div>
          </div>
        </div>

        <!-- Vista de Clases del Curso -->
        <div id="courseClassesView" style="display: none;">
          <div class="classes-header">
            <h2 id="currentCourseName">Clases del Curso</h2>
            <div class="view-classes-controls">
              <button class="btn btn-secondary btn-small" onclick="backToCourses()">
                ‚Üê Volver a Cursos
              </button>
              <button class="btn btn-small" onclick="createClassInCurrentCourse()">
                + Nueva Clase
              </button>
              <!-- <button id="expandAllBtn" class="expand-all-btn" onclick="toggleAllClasses()">
                <span id="expandAllIcon">‚ñº</span>
                <span id="expandAllText">Expandir todas</span>
              </button> -->
            </div>
          </div>
          <div id="classesList" class="classes-list">
            <div class="empty-state">
              <p>No hay clases programadas para este curso.<br>¬°Crea tu primera clase!</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Create Class Tab (oculto, solo se usa como modal/formulario) -->
    <div id="createTab" class="tab-content">
      <div class="card">
        <div class="classes-header">
          <h2>Nueva Clase</h2>
          <button class="btn btn-secondary btn-small" onclick="cancelCreateClass()">
            ‚Üê Volver
          </button>
        </div>
        <form id="classForm">
          <div class="form-group">
            <label for="courseName">Curso</label>
            <select id="courseName" required disabled>
              <option value="">-- Curso seleccionado --</option>
            </select>
          </div>

          <div class="form-group">
            <label for="classDate">Fecha de la Clase</label>
            <input type="date" id="classDate" required />
          </div>

          <div class="form-group activities-section">
            <label>Actividades de la Clase</label>
            <div id="activitiesList">
              <!-- Las actividades se generan din√°micamente -->
            </div>
            <button type="button" class="add-activity" onclick="addActivity()">
              + Agregar Actividad
            </button>
          </div>

          <div class="form-group">
            <label for="homework">Tarea</label>
            <textarea id="homework" placeholder=""></textarea>

            <!-- Homework Resources Section -->
            <button type="button" class="add-resource-trigger homework-resources-trigger"
              onclick="toggleHomeworkResources()">
              Agregar recursos
            </button>
            <div id="homeworkResourcesSection" class="resources-main-section">
              <div class="resource-type-selector">
                <button type="button" class="resource-type-btn active"
                  onclick="toggleHomeworkResourceType(this, 'file')">
                  Subir archivo
                </button>
                <button type="button" class="resource-type-btn" onclick="toggleHomeworkResourceType(this, 'link')">
                  Agregar enlace
                </button>
              </div>

              <div class="file-upload-section">
                <div class="file-upload-area" onclick="triggerHomeworkFileInput()">
                  <input type="file" id="homeworkFileInput" class="file-input" accept=".pdf,.jpg,.jpeg,.png,.gif"
                    multiple onchange="handleHomeworkFileSelect(this)" />
                  <div class="file-upload-text">Subir archivos</div>
                  <div class="file-upload-hint">
                    Arrastra archivos aqu√≠ o haz clic para seleccionar<br />Soporta:
                    PDF, JPG, PNG, GIF (m√°x. 10MB)
                  </div>
                </div>
                <div id="homeworkUploadedFiles" class="uploaded-files"></div>
              </div>

              <div class="link-upload-section" style="display: none">
                <div class="add-resource-section">
                  <div class="resource-inputs">
                    <input type="text" id="homeworkResourceName" placeholder="Nombre del recurso" />
                    <input type="url" id="homeworkResourceUrl" placeholder="https://..." />
                  </div>
                  <button type="button" class="add-resource-btn" onclick="addHomeworkLinkResource()">
                    Agregar Enlace
                  </button>
                </div>
                <div id="homeworkLinkResourcesList" class="link-resources-list"></div>
              </div>
            </div>
          </div>

          <button type="submit" class="btn">Guardar Clase</button>
        </form>
      </div>
    </div>

    <!-- View Classes Tab -->
    <div id="viewTab" class="tab-content">
      <div class="card">
        <div class="classes-header">
          <h2>Clases del Curso</h2>
          <div class="view-classes-controls">
            <button class="btn btn-secondary btn-small" onclick="backToCourses()">
              ‚Üê Volver a Cursos
            </button>
            <button id="expandAllBtn" class="expand-all-btn" onclick="toggleAllClasses()">
              <span id="expandAllIcon"></span>
              <span id="expandAllText">Expandir todas</span>
            </button>
          </div>
        </div>
        <div id="classesList" class="classes-list">
          <div class="empty-state">
            <p>No hay clases programadas para este curso.<br>¬°Crea tu primera clase!</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Translate Tab -->
    <div id="translateTab" class="tab-content">
      <div class="card">
        <h2>Traductor</h2>

        <div class="translate-container">
          <div class="translate-panel">
            <div class="translate-header">
              <select id="sourceLang" class="lang-select">
                <option value="en">English</option>
                <option value="es">Espa√±ol</option>
              </select>
              <button class="swap-languages-btn" onclick="swapLanguages()" title="Intercambiar idiomas">
                üîÑ
              </button>
              <select id="targetLang" class="lang-select">
                <option value="es">Espa√±ol</option>
                <option value="en">English</option>
              </select>
            </div>

            <div class="translate-content">
              <div class="translate-input-section">
                <label for="sourceText">Texto original:</label>
                <textarea id="sourceText" placeholder="Escribe o pega el texto aqu√≠..." rows="8"></textarea>
                <div class="char-count" id="sourceCharCount">
                  0 / 5000 caracteres
                </div>
              </div>

              <div class="translate-output-section">
                <label for="targetText">Traducci√≥n:</label>
                <textarea id="targetText" placeholder="La traducci√≥n aparecer√° aqu√≠..." rows="8" readonly></textarea>
                <button class="copy-translation-btn" onclick="copyTranslation()" title="Copiar traducci√≥n">
                  Copiar
                </button>
              </div>
            </div>

            <div class="translate-actions">
              <button class="btn" onclick="translateText()">
                Traducir
              </button>
              <button class="btn btn-secondary" onclick="clearTranslation()">
                Limpiar
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Class Detail Modal -->
    <div id="classDetailModal" class="modal class-detail-modal">
      <div class="modal-content class-detail-content">
        <div class="modal-header">
          <h3 class="modal-title" id="classDetailTitle">
            Detalles de la Clase
          </h3>
          <button class="modal-close" onclick="closeClassDetailModal()">
            √ó
          </button>
        </div>
        <div class="modal-body" id="classDetailBody">
          <!-- Class detail content will be inserted here -->
        </div>
      </div>
    </div>

    <!-- File Preview Modal -->
    <div id="fileModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="modalTitle">Vista previa</h3>
          <button class="modal-close" onclick="closeModal()">√ó</button>
        </div>
        <div class="modal-body" id="modalBody">
          <!-- File preview content will be inserted here -->
        </div>
      </div>
    </div>

    <!-- Share Class Modal -->
    <div id="shareModal" class="share-modal">
      <div class="share-modal-content">
        <div class="share-modal-header">
          <h3 class="share-modal-title">Compartir Clase</h3>
        </div>
        <div class="share-modal-body">
          <div id="shareSuccess" class="share-success">
            Enlace copiado al portapapeles
          </div>

          <div class="share-options">
            <div class="share-option" onclick="shareAsJson()">
              <div class="share-option-icon"></div>
              <div class="share-option-content">
                <div class="share-option-title">Descargar archivo</div>
                <div class="share-option-description">
                  Guardar la clase como archivo JSON
                </div>
              </div>
            </div>

            <div class="share-option" onclick="exportClassWithFiles()">
              <div class="share-option-icon"></div>
              <div class="share-option-content">
                <div class="share-option-title">Exportar con archivos</div>
                <div class="share-option-description">
                  Descargar archivo HTML con todos los archivos incluidos
                </div>
              </div>
            </div>

            <div class="share-option" onclick="shareAsText()">
              <div class="share-option-icon"></div>
              <div class="share-option-content">
                <div class="share-option-title">Copiar como texto</div>
                <div class="share-option-description">
                  Copiar el contenido de la clase como texto plano
                </div>
              </div>
            </div>
          </div>

          <div class="share-actions">
            <button class="btn btn-secondary" onclick="closeShareModal()">
              Cancelar
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="script.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/quill/1.3.7/quill.min.js"></script>
    <input type="file" id="importFileInput" accept=".json" style="display: none" onchange="handleFileImport(this)" />
</body>

</html>